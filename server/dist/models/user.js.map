{"version":3,"sources":["../../server/models/user.js"],"names":["module","exports","sequelize","DataTypes","user","define","username","type","STRING","allowNull","email","validate","isEmail","password","password_hasher","VIRTUAL","set","val","setDataValue","salt","isLongEnough","length","Error","phone","INTEGER","classMethods","associate","models","hasMany","group","foreignKey","as","message"],"mappings":";;AAAAA,OAAOC,OAAP,GAAiB,UAACC,SAAD,EAAYC,SAAZ,EAA0B;AACzC,MAAMC,OAAOF,UAAUG,MAAV,CAAiB,MAAjB,EAAyB;AACpCC,cAAU,EAAEC,MAAMJ,UAAUK,MAAlB;AACRC,iBAAW,KADH,EAD0B;AAGpCC,WAAO,EAAEH,MAAMJ,UAAUK,MAAlB;AACLC,iBAAW,KADN;AAELE,gBAAU;AACRC,iBAAS;AADD;AAFL,KAH6B;AASpCC,cAAU,EAAEN,MAAMJ,UAAUK,MAAlB;AACRC,iBAAW;AADH,KAT0B;AAYpCK,qBAAiB;AACfP,YAAMJ,UAAUY,OADD;AAEfC,WAAK,aAACC,GAAD,EAAS;AACZ,kBAAKC,YAAL,CAAkB,iBAAlB,EAAqCD,GAArC;AACA,kBAAKC,YAAL,CAAkB,UAAlB,EAA8B,UAAKC,IAAL,GAAYF,GAA1C;AACD,OALc;AAMfN,gBAAU;AACRS,sBAAc,sBAACH,GAAD,EAAS;AACrB,cAAIA,IAAII,MAAJ,GAAa,CAAjB,EAAoB;AAClB,kBAAM,IAAIC,KAAJ,CAAU,iCAAV,CAAN;AACD;AACF;AALO;AANK,KAZmB;AA0BpCC,WAAOpB,UAAUqB;AA1BmB,GAAzB,EA2BV;AACDC,kBAAc;AACZC,iBAAW,mBAACC,MAAD,EAAY;AACrBvB,aAAKwB,OAAL,CAAaD,OAAOE,KAApB,EAA2B;AACzBC,sBAAY,QADa;AAEzBC,cAAI;AAFqB,SAA3B;AAIA3B,aAAKwB,OAAL,CAAaD,OAAOK,OAApB,EAA6B;AAC3BF,sBAAY,QADe;AAE3BC,cAAI;AAFuB,SAA7B;AAID;AAVW;AADb,GA3BU,CAAb;;AA0CA,SAAO3B,IAAP;AACD,CA5CD","file":"user.js","sourcesContent":["module.exports = (sequelize, DataTypes) => {\n  const user = sequelize.define('user', {\n    username: { type: DataTypes.STRING,\n      allowNull: false },\n    email: { type: DataTypes.STRING,\n      allowNull: false,\n      validate: {\n        isEmail: true\n      }\n    },\n    password: { type: DataTypes.STRING,\n      allowNull: false,\n    },\n    password_hasher: {\n      type: DataTypes.VIRTUAL,\n      set: (val) => {\n        this.setDataValue('password_hasher', val);\n        this.setDataValue('password', this.salt + val);\n      },\n      validate: {\n        isLongEnough: (val) => {\n          if (val.length < 7) {\n            throw new Error('Please choose a longer password');\n          }\n        }\n      }\n    },\n    phone: DataTypes.INTEGER\n  }, {\n    classMethods: {\n      associate: (models) => {\n        user.hasMany(models.group, {\n          foreignKey: 'userId',\n          as: 'groups',\n        });\n        user.hasMany(models.message, {\n          foreignKey: 'userId',\n          as: 'messages',\n        });\n      },\n    }\n  });\n\n  return user;\n};\n"]}